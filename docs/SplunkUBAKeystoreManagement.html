<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=DFQxm4rd7fRHgM9OTejWVT5Vho6BE7M80rHXEVKqXWegg2XYR88pwOsaJkfiF7cJu5e0vFtnyLdhsxviZUUN-U0KZVwUvSK-LyXz4qcE1hc);.lst-kix_list_c-0>li:before{content:"" counter(lst-ctn-kix_list_c-0,decimal) ". "}ol.lst-kix_list_7-0{list-style-type:none}ul.lst-kix_list_b-8{list-style-type:none}ul.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_c-1>li:before{content:"\0025cb   "}ol.lst-kix_list_9-0.start{counter-reset:lst-ctn-kix_list_9-0 0}ul.lst-kix_list_b-3{list-style-type:none}ul.lst-kix_list_b-2{list-style-type:none}.lst-kix_list_c-3>li:before{content:"\0025a0   "}.lst-kix_list_c-4>li:before{content:"\0025a0   "}ul.lst-kix_list_b-1{list-style-type:none}ul.lst-kix_list_b-7{list-style-type:none}ul.lst-kix_list_b-6{list-style-type:none}.lst-kix_list_c-2>li:before{content:"\0025a0   "}ul.lst-kix_list_b-5{list-style-type:none}ul.lst-kix_list_b-4{list-style-type:none}ul.lst-kix_list_9-3{list-style-type:none}ul.lst-kix_list_9-4{list-style-type:none}ul.lst-kix_list_9-1{list-style-type:none}ul.lst-kix_list_9-2{list-style-type:none}ul.lst-kix_list_9-7{list-style-type:none}ul.lst-kix_list_9-8{list-style-type:none}ul.lst-kix_list_9-5{list-style-type:none}.lst-kix_list_7-0>li{counter-increment:lst-ctn-kix_list_7-0}.lst-kix_list_9-0>li{counter-increment:lst-ctn-kix_list_9-0}ul.lst-kix_list_9-6{list-style-type:none}ul.lst-kix_list_1-3{list-style-type:none}ul.lst-kix_list_1-4{list-style-type:none}ul.lst-kix_list_1-1{list-style-type:none}ul.lst-kix_list_1-2{list-style-type:none}ul.lst-kix_list_1-7{list-style-type:none}ul.lst-kix_list_1-8{list-style-type:none}ul.lst-kix_list_1-5{list-style-type:none}ul.lst-kix_list_1-6{list-style-type:none}.lst-kix_list_5-0>li:before{content:"\0025cf   "}.lst-kix_list_5-3>li:before{content:"\0025a0   "}ul.lst-kix_list_a-4{list-style-type:none}ul.lst-kix_list_a-3{list-style-type:none}.lst-kix_list_5-2>li:before{content:"\0025a0   "}ul.lst-kix_list_a-2{list-style-type:none}ul.lst-kix_list_a-1{list-style-type:none}.lst-kix_list_5-1>li:before{content:"\0025cb   "}ul.lst-kix_list_a-8{list-style-type:none}ul.lst-kix_list_a-7{list-style-type:none}ul.lst-kix_list_a-6{list-style-type:none}ul.lst-kix_list_a-5{list-style-type:none}.lst-kix_list_5-7>li:before{content:"\0025a0   "}ul.lst-kix_list_8-4{list-style-type:none}ul.lst-kix_list_8-5{list-style-type:none}.lst-kix_list_5-6>li:before{content:"\0025a0   "}.lst-kix_list_5-8>li:before{content:"\0025a0   "}ul.lst-kix_list_8-2{list-style-type:none}ul.lst-kix_list_8-3{list-style-type:none}ul.lst-kix_list_8-8{list-style-type:none}ul.lst-kix_list_8-6{list-style-type:none}ul.lst-kix_list_8-7{list-style-type:none}.lst-kix_list_d-6>li:before{content:"\0025a0   "}.lst-kix_list_5-4>li:before{content:"\0025a0   "}.lst-kix_list_5-5>li:before{content:"\0025a0   "}.lst-kix_list_d-8>li:before{content:"\0025a0   "}ul.lst-kix_list_8-1{list-style-type:none}.lst-kix_list_d-7>li:before{content:"\0025a0   "}.lst-kix_list_c-0>li{counter-increment:lst-ctn-kix_list_c-0}.lst-kix_list_d-2>li:before{content:"\0025a0   "}.lst-kix_list_6-1>li:before{content:"\0025cb   "}.lst-kix_list_6-3>li:before{content:"\0025a0   "}.lst-kix_list_d-1>li:before{content:"\0025cb   "}.lst-kix_list_d-5>li:before{content:"\0025a0   "}.lst-kix_list_6-0>li:before{content:"\0025cf   "}.lst-kix_list_6-4>li:before{content:"\0025a0   "}ol.lst-kix_list_4-0.start{counter-reset:lst-ctn-kix_list_4-0 0}.lst-kix_list_d-4>li:before{content:"\0025a0   "}.lst-kix_list_d-3>li:before{content:"\0025a0   "}.lst-kix_list_6-2>li:before{content:"\0025a0   "}.lst-kix_list_c-7>li:before{content:"\0025a0   "}ol.lst-kix_list_d-0.start{counter-reset:lst-ctn-kix_list_d-0 0}.lst-kix_list_c-5>li:before{content:"\0025a0   "}.lst-kix_list_c-8>li:before{content:"\0025a0   "}.lst-kix_list_6-8>li:before{content:"\0025a0   "}.lst-kix_list_6-5>li:before{content:"\0025a0   "}.lst-kix_list_6-7>li:before{content:"\0025a0   "}.lst-kix_list_d-0>li:before{content:"" counter(lst-ctn-kix_list_d-0,decimal) ". "}.lst-kix_list_c-6>li:before{content:"\0025a0   "}.lst-kix_list_6-6>li:before{content:"\0025a0   "}.lst-kix_list_2-7>li:before{content:"\0025a0   "}ul.lst-kix_list_d-8{list-style-type:none}ul.lst-kix_list_d-7{list-style-type:none}.lst-kix_list_7-4>li:before{content:"\0025a0   "}.lst-kix_list_7-6>li:before{content:"\0025a0   "}ul.lst-kix_list_d-6{list-style-type:none}.lst-kix_list_2-5>li:before{content:"\0025a0   "}ul.lst-kix_list_d-1{list-style-type:none}.lst-kix_list_b-8>li:before{content:"\0025a0   "}.lst-kix_list_7-2>li:before{content:"\0025a0   "}ul.lst-kix_list_d-5{list-style-type:none}ul.lst-kix_list_d-4{list-style-type:none}ul.lst-kix_list_d-3{list-style-type:none}ul.lst-kix_list_d-2{list-style-type:none}.lst-kix_list_b-4>li:before{content:"\0025a0   "}ul.lst-kix_list_3-7{list-style-type:none}ul.lst-kix_list_3-8{list-style-type:none}ul.lst-kix_list_3-1{list-style-type:none}ul.lst-kix_list_3-2{list-style-type:none}.lst-kix_list_7-8>li:before{content:"\0025a0   "}ul.lst-kix_list_3-0{list-style-type:none}ul.lst-kix_list_3-5{list-style-type:none}ol.lst-kix_list_9-0{list-style-type:none}ul.lst-kix_list_3-6{list-style-type:none}.lst-kix_list_b-6>li:before{content:"\0025a0   "}ul.lst-kix_list_3-3{list-style-type:none}ul.lst-kix_list_3-4{list-style-type:none}.lst-kix_list_b-0>li:before{content:"" counter(lst-ctn-kix_list_b-0,decimal) ". "}.lst-kix_list_4-1>li:before{content:"\0025cb   "}.lst-kix_list_b-2>li:before{content:"\0025a0   "}.lst-kix_list_9-2>li:before{content:"\0025a0   "}.lst-kix_list_4-3>li:before{content:"\0025a0   "}.lst-kix_list_4-5>li:before{content:"\0025a0   "}ol.lst-kix_list_e-0.start{counter-reset:lst-ctn-kix_list_e-0 0}ol.lst-kix_list_b-0{list-style-type:none}.lst-kix_list_9-0>li:before{content:"" counter(lst-ctn-kix_list_9-0,decimal) ". "}ul.lst-kix_list_c-8{list-style-type:none}ul.lst-kix_list_c-7{list-style-type:none}.lst-kix_list_9-6>li:before{content:"\0025a0   "}ul.lst-kix_list_c-2{list-style-type:none}ul.lst-kix_list_c-1{list-style-type:none}.lst-kix_list_9-4>li:before{content:"\0025a0   "}ul.lst-kix_list_c-6{list-style-type:none}.lst-kix_list_a-0>li:before{content:"" counter(lst-ctn-kix_list_a-0,decimal) ". "}ul.lst-kix_list_c-5{list-style-type:none}ul.lst-kix_list_c-4{list-style-type:none}ul.lst-kix_list_c-3{list-style-type:none}ul.lst-kix_list_2-8{list-style-type:none}ol.lst-kix_list_b-0.start{counter-reset:lst-ctn-kix_list_b-0 0}ul.lst-kix_list_2-2{list-style-type:none}ul.lst-kix_list_2-3{list-style-type:none}ul.lst-kix_list_2-0{list-style-type:none}ul.lst-kix_list_2-1{list-style-type:none}ol.lst-kix_list_8-0{list-style-type:none}.lst-kix_list_9-8>li:before{content:"\0025a0   "}ul.lst-kix_list_2-6{list-style-type:none}.lst-kix_list_1-1>li:before{content:"\0025cb   "}ul.lst-kix_list_2-7{list-style-type:none}ul.lst-kix_list_2-4{list-style-type:none}ul.lst-kix_list_2-5{list-style-type:none}.lst-kix_list_e-0>li{counter-increment:lst-ctn-kix_list_e-0}.lst-kix_list_b-0>li{counter-increment:lst-ctn-kix_list_b-0}.lst-kix_list_1-3>li:before{content:"\0025a0   "}.lst-kix_list_1-7>li:before{content:"\0025a0   "}.lst-kix_list_1-5>li:before{content:"\0025a0   "}.lst-kix_list_2-1>li:before{content:"\0025cb   "}ol.lst-kix_list_a-0{list-style-type:none}.lst-kix_list_2-3>li:before{content:"\0025a0   "}.lst-kix_list_3-0>li:before{content:"\0025cf   "}ul.lst-kix_list_5-7{list-style-type:none}ul.lst-kix_list_5-8{list-style-type:none}.lst-kix_list_3-1>li:before{content:"\0025cb   "}.lst-kix_list_3-2>li:before{content:"\0025a0   "}ul.lst-kix_list_5-5{list-style-type:none}ol.lst-kix_list_c-0.start{counter-reset:lst-ctn-kix_list_c-0 0}ul.lst-kix_list_5-6{list-style-type:none}.lst-kix_list_8-1>li:before{content:"\0025cb   "}.lst-kix_list_4-0>li{counter-increment:lst-ctn-kix_list_4-0}.lst-kix_list_8-2>li:before{content:"\0025a0   "}.lst-kix_list_8-0>li{counter-increment:lst-ctn-kix_list_8-0}.lst-kix_list_3-5>li:before{content:"\0025a0   "}ul.lst-kix_list_5-0{list-style-type:none}.lst-kix_list_3-4>li:before{content:"\0025a0   "}ul.lst-kix_list_5-3{list-style-type:none}.lst-kix_list_3-3>li:before{content:"\0025a0   "}ul.lst-kix_list_5-4{list-style-type:none}ul.lst-kix_list_5-1{list-style-type:none}.lst-kix_list_8-0>li:before{content:"" counter(lst-ctn-kix_list_8-0,decimal) ". "}ul.lst-kix_list_5-2{list-style-type:none}.lst-kix_list_8-7>li:before{content:"\0025a0   "}.lst-kix_list_3-8>li:before{content:"\0025a0   "}.lst-kix_list_8-5>li:before{content:"\0025a0   "}.lst-kix_list_a-7>li:before{content:"\0025a0   "}.lst-kix_list_8-6>li:before{content:"\0025a0   "}.lst-kix_list_8-3>li:before{content:"\0025a0   "}.lst-kix_list_3-6>li:before{content:"\0025a0   "}.lst-kix_list_3-7>li:before{content:"\0025a0   "}.lst-kix_list_a-8>li:before{content:"\0025a0   "}.lst-kix_list_8-4>li:before{content:"\0025a0   "}ol.lst-kix_list_d-0{list-style-type:none}.lst-kix_list_a-1>li:before{content:"\0025cb   "}.lst-kix_list_a-2>li:before{content:"\0025a0   "}.lst-kix_list_a-3>li:before{content:"\0025a0   "}.lst-kix_list_a-5>li:before{content:"\0025a0   "}.lst-kix_list_a-6>li:before{content:"\0025a0   "}.lst-kix_list_a-4>li:before{content:"\0025a0   "}.lst-kix_list_8-8>li:before{content:"\0025a0   "}.lst-kix_list_e-5>li:before{content:"\0025a0   "}ul.lst-kix_list_e-8{list-style-type:none}ul.lst-kix_list_e-7{list-style-type:none}ul.lst-kix_list_e-6{list-style-type:none}ul.lst-kix_list_e-5{list-style-type:none}.lst-kix_list_e-3>li:before{content:"\0025a0   "}.lst-kix_list_e-7>li:before{content:"\0025a0   "}.lst-kix_list_e-2>li:before{content:"\0025a0   "}.lst-kix_list_e-6>li:before{content:"\0025a0   "}.lst-kix_list_4-8>li:before{content:"\0025a0   "}.lst-kix_list_4-7>li:before{content:"\0025a0   "}ul.lst-kix_list_e-4{list-style-type:none}ul.lst-kix_list_e-3{list-style-type:none}ul.lst-kix_list_e-2{list-style-type:none}.lst-kix_list_e-4>li:before{content:"\0025a0   "}ul.lst-kix_list_e-1{list-style-type:none}ul.lst-kix_list_4-8{list-style-type:none}ul.lst-kix_list_4-6{list-style-type:none}ul.lst-kix_list_4-7{list-style-type:none}.lst-kix_list_e-1>li:before{content:"\0025cb   "}ul.lst-kix_list_4-1{list-style-type:none}ul.lst-kix_list_4-4{list-style-type:none}ul.lst-kix_list_4-5{list-style-type:none}ul.lst-kix_list_4-2{list-style-type:none}.lst-kix_list_e-0>li:before{content:"" counter(lst-ctn-kix_list_e-0,decimal) ". "}ul.lst-kix_list_4-3{list-style-type:none}.lst-kix_list_d-0>li{counter-increment:lst-ctn-kix_list_d-0}ol.lst-kix_list_c-0{list-style-type:none}ol.lst-kix_list_8-0.start{counter-reset:lst-ctn-kix_list_8-0 0}.lst-kix_list_7-0>li:before{content:"" counter(lst-ctn-kix_list_7-0,decimal) ". "}.lst-kix_list_2-6>li:before{content:"\0025a0   "}.lst-kix_list_2-4>li:before{content:"\0025a0   "}.lst-kix_list_2-8>li:before{content:"\0025a0   "}.lst-kix_list_7-1>li:before{content:"\0025cb   "}.lst-kix_list_7-5>li:before{content:"\0025a0   "}.lst-kix_list_7-3>li:before{content:"\0025a0   "}ul.lst-kix_list_7-5{list-style-type:none}ul.lst-kix_list_7-6{list-style-type:none}.lst-kix_list_b-5>li:before{content:"\0025a0   "}ul.lst-kix_list_7-3{list-style-type:none}ul.lst-kix_list_7-4{list-style-type:none}.lst-kix_list_b-3>li:before{content:"\0025a0   "}.lst-kix_list_b-7>li:before{content:"\0025a0   "}ul.lst-kix_list_7-7{list-style-type:none}ul.lst-kix_list_7-8{list-style-type:none}ol.lst-kix_list_a-0.start{counter-reset:lst-ctn-kix_list_a-0 0}ul.lst-kix_list_7-1{list-style-type:none}ul.lst-kix_list_7-2{list-style-type:none}.lst-kix_list_7-7>li:before{content:"\0025a0   "}.lst-kix_list_4-0>li:before{content:"" counter(lst-ctn-kix_list_4-0,decimal) ". "}.lst-kix_list_b-1>li:before{content:"\0025cb   "}.lst-kix_list_4-4>li:before{content:"\0025a0   "}.lst-kix_list_4-2>li:before{content:"\0025a0   "}.lst-kix_list_4-6>li:before{content:"\0025a0   "}.lst-kix_list_9-3>li:before{content:"\0025a0   "}ol.lst-kix_list_7-0.start{counter-reset:lst-ctn-kix_list_7-0 0}.lst-kix_list_9-1>li:before{content:"\0025cb   "}.lst-kix_list_e-8>li:before{content:"\0025a0   "}ol.lst-kix_list_4-0{list-style-type:none}.lst-kix_list_9-7>li:before{content:"\0025a0   "}.lst-kix_list_9-5>li:before{content:"\0025a0   "}ul.lst-kix_list_6-6{list-style-type:none}ul.lst-kix_list_6-7{list-style-type:none}ul.lst-kix_list_6-4{list-style-type:none}ul.lst-kix_list_6-5{list-style-type:none}ul.lst-kix_list_6-8{list-style-type:none}.lst-kix_list_1-0>li:before{content:"\0025cf   "}ul.lst-kix_list_6-2{list-style-type:none}.lst-kix_list_a-0>li{counter-increment:lst-ctn-kix_list_a-0}ul.lst-kix_list_6-3{list-style-type:none}.lst-kix_list_1-2>li:before{content:"\0025a0   "}ul.lst-kix_list_6-0{list-style-type:none}ul.lst-kix_list_6-1{list-style-type:none}.lst-kix_list_1-4>li:before{content:"\0025a0   "}.lst-kix_list_1-6>li:before{content:"\0025a0   "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_list_e-0{list-style-type:none}.lst-kix_list_2-0>li:before{content:"\0025cf   "}.lst-kix_list_1-8>li:before{content:"\0025a0   "}.lst-kix_list_2-2>li:before{content:"\0025a0   "}ol{margin:0;padding:0}table td,table th{padding:0}.c6{border-right-style:solid;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:93.6pt;border-top-color:#000000;border-bottom-style:solid}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Google Sans Text";font-style:normal}.c2{-webkit-text-decoration-skip:none;color:#0000ee;font-weight:400;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;font-family:"Google Sans"}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:12pt;font-family:"Google Sans Text";font-style:normal}.c8{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Google Sans";font-style:normal}.c25{color:#000000;font-weight:700;text-decoration:none;font-size:18pt;font-family:"Google Sans"}.c29{color:#000000;font-weight:700;text-decoration:none;font-size:24pt;font-family:"Google Sans"}.c13{color:#000000;font-weight:700;text-decoration:none;font-size:14pt;font-family:"Google Sans"}.c30{color:#000000;font-weight:700;text-decoration:none;font-size:12pt;font-family:"Google Sans"}.c22{padding-top:0pt;padding-bottom:11.2pt;line-height:1.149999976158142;text-align:left}.c27{padding-top:24pt;padding-bottom:0pt;line-height:1.149999976158142;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.149999976158142;text-align:left}.c24{border-spacing:0;border-collapse:collapse;margin-right:auto}.c12{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c23{padding-top:0pt;padding-bottom:12.8pt;line-height:1.0;text-align:left}.c26{padding-top:0pt;padding-bottom:12.8pt;line-height:1.149999976158142;text-align:left}.c5{padding-top:0pt;padding-bottom:12pt;line-height:1.149999976158142;text-align:left}.c14{color:#000000;text-decoration:none;font-size:11pt}.c10{font-size:12pt;font-weight:400;font-family:"Google Sans"}.c28{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{vertical-align:baseline;font-style:normal}.c20{color:inherit;text-decoration:inherit}.c11{font-weight:700;font-family:"Google Sans Text"}.c21{vertical-align:super;font-size:12pt}.c7{margin-left:30pt;padding-left:0pt}.c15{font-weight:400;font-family:"Arial"}.c19{padding:0;margin:0}.c4{font-weight:400;font-family:"Google Sans Text"}.c17{font-style:italic}.c16{height:11pt}.c18{height:0pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.0;page-break-after:avoid;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0;page-break-after:avoid;font-style:italic;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:12pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:12pt;font-family:"Arial";line-height:1.0;text-align:left}h2{padding-top:11.2pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:11.2pt;font-family:"Arial";line-height:1.0;text-align:left}h3{padding-top:12pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:12pt;font-family:"Arial";line-height:1.0;text-align:left}h4{padding-top:12.8pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:12.8pt;font-family:"Arial";line-height:1.0;text-align:left}h5{padding-top:12.8pt;color:#000000;font-weight:700;font-size:9pt;padding-bottom:12.8pt;font-family:"Arial";line-height:1.0;text-align:left}h6{padding-top:18pt;color:#000000;font-weight:700;font-size:8pt;padding-bottom:18pt;font-family:"Arial";line-height:1.0;text-align:left}</style></head><body class="c28 doc-content"><p class="c0 c16"><span class="c14 c9 c15"></span></p><h1 class="c5"><span class="c9 c29">A Comprehensive Guide to Splunk UBA Keystore and Truststore Management</span></h1><p class="c0 c16"><span class="c8"></span></p><p class="c0 c16"><span class="c8"></span></p><h2 class="c22"><span class="c25 c9">I. Introduction to Keystore Management in Splunk UBA</span></h2><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Keystores and truststores are fundamental to establishing secure communication channels within and around Splunk User Behavior Analytics (UBA). They serve as repositories for cryptographic keys and certificates, which are essential for identity verification, data encryption, and ensuring the integrity of data exchanges. In a security-focused product like UBA, robust certificate management is paramount to protect sensitive user behavior data and maintain the trustworthiness of threat detection. This secure communication prevents unauthorized access, data tampering, and ensures the authenticity of data sources and destinations.</span></p><p class="c0"><span class="c4">The consistent emphasis across various documentation on using certificates for SSL/TLS validation </span><span class="c21 c4">1</span><span class="c1">&nbsp;reveals that this is not merely about encrypting data in transit. It is fundamentally about establishing and maintaining trust between UBA and other critical components of the Splunk ecosystem, such as Splunk Enterprise, Splunk Enterprise Security (ES), and Kafka. If UBA cannot validate the identity of these external or internal communication partners, it creates significant vulnerabilities, potentially opening doors to Man-in-the-Middle (MITM) attacks, data corruption, or unauthorized data exfiltration. Therefore, keystores and truststores represent a foundational security layer that underpins all secure operations and the overall integrity of the UBA platform.</span></p><p class="c0"><span class="c1">Splunk UBA leverages several distinct types of keystores and truststores, each serving a specific purpose within its security architecture. These include Java&#39;s default cacerts truststore for validating external system certificates, a UBA-specific keystore (uba-keystore) for internal cluster communication, dedicated keystores and truststores for securing Kafka data ingestion, and certificates for the Splunk UBA web interface. A clear understanding of the role, location, and management procedures for each is crucial for effective and secure UBA administration.</span></p><p class="c0 c16"><span class="c1"></span></p><h2 class="c22"><span class="c25 c9">II. Understanding Splunk UBA Keystores and Truststores</span></h2><p class="c0 c16"><span class="c8"></span></p><p class="c0 c16"><span class="c8"></span></p><h3 class="c5"><span class="c13 c9">A. Java cacerts Truststore</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">The Java cacerts truststore is a critical component for Splunk UBA to validate the SSL certificates of external systems with which it communicates. This primarily includes Splunk Enterprise, for data source validation, and Splunk Enterprise Security (ES), for both validating incoming data sources and trusting the ES platform when UBA sends audit events, anomalies, and threats. Proper configuration ensures UBA trusts the identity of these platforms, enabling secure data flow and preventing connection failures.</span></p><p class="c0"><span class="c4">The cacerts truststore&#39;s role is not singular; it serves a dual purpose. It is explicitly used for validating incoming SSL certificates from Splunk Enterprise when UBA consumes data </span><span class="c4 c21">1</span><span class="c4">, and for trusting the Splunk ES certificate when UBA sends audit events or anomalies.</span><span class="c21 c4">2</span><span class="c1">&nbsp;This demonstrates its function as a central trust anchor for both inbound and outbound secure communications with the broader Splunk ecosystem.</span></p><p class="c0"><span class="c14 c9 c11">Default Locations:</span></p><ul class="c19 lst-kix_list_1-0 start"><li class="c0 c7 li-bullet-0"><span class="c4">On RHEL (Red Hat Enterprise Linux) and OEL (Oracle Enterprise Linux) systems, the cacerts truststore is typically found at $JAVA_HOME/lib/security/cacerts.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">On Ubuntu and other Linux systems, the location is $JAVA_HOME/jre/lib/security/cacerts.</span><span class="c3">1</span></li></ul><p class="c0"><span class="c1">Default Password:</span></p><p class="c0"><span class="c1">The default password for the Java cacerts truststore is consistently identified as changeit across multiple sources.1 This default is a significant security vulnerability and must be changed in any production environment to prevent unauthorized access to the truststore.</span></p><p class="c0"><span class="c4">The instruction to export certificates </span><span class="c4 c17">before</span><span class="c4">&nbsp;an upgrade </span><span class="c21 c4">7</span><span class="c1">&nbsp;and the explicit statement about the necessity of updating the UBA keystore whenever a</span></p><p class="c0"><span class="c4 c17">new</span><span class="c4">&nbsp;ES certificate is installed </span><span class="c21 c4">6</span><span class="c1">&nbsp;highlight the critical importance of proactive certificate lifecycle management. Ignoring renewal or replacement procedures can lead to integration outages and security vulnerabilities, emphasizing that certificate management is an ongoing operational task, not a one-time setup.</span></p><p class="c0 c16"><span class="c1"></span></p><h3 class="c5"><span class="c13 c9">B. UBA-Specific Keystore (uba-keystore)</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">The uba-keystore is specifically designed to store certificates relevant to Splunk UBA&#39;s internal operations and secure communication within the UBA cluster. This includes loading certificates from the Splunk instance for integration and ensuring that UBA nodes can securely authenticate and communicate with each other. This internal trust is vital for the distributed architecture of UBA.</span></p><p class="c0"><span class="c1">Default Location:</span></p><p class="c0"><span class="c1">The uba-keystore is located at /etc/caspida/conf/keystore/uba-keystore.1</span></p><p class="c0"><span class="c1">Default Password:</span></p><p class="c0"><span class="c1">The example commands consistently use password as the storepass for uba-keystore.1 Similar to</span></p><p class="c0"><span class="c1">cacerts, this indicates it is likely the default or a commonly used placeholder that should be changed as a security best practice.</span></p><p class="c0"><span class="c4">The explicit command /opt/caspida/bin/Caspida setup-uba-keystore to &quot;sync the keystore with all UBA nodes&quot; </span><span class="c21 c4">1</span><span class="c1">&nbsp;highlights a critical operational requirement unique to distributed UBA deployments. Unlike</span></p><p class="c0"><span class="c1">cacerts, which might be managed per node for external trust, changes to the uba-keystore must be propagated across the entire cluster to maintain consistent internal secure communication and prevent authentication failures between UBA components. This emphasizes the need for a centralized management approach for this specific keystore.</span></p><p class="c0"><span class="c4">Furthermore, documentation indicates that the validate.uba.ssl.certificate property, which enforces certificate and hostname validation for UBA internal communication, is false by default.</span><span class="c21 c4">8</span><span class="c1">&nbsp;This implies an initial assumption of a trusted internal network. Setting this to</span></p><p class="c0"><span class="c1">true provides a significant hardening opportunity to explicitly validate internal UBA node communications, mitigating risks like insider threats or compromised internal network segments. This moves beyond perimeter security to internal segmentation and trust, which is a crucial security recommendation for robust deployments.</span></p><p class="c0 c16"><span class="c1"></span></p><h3 class="c5"><span class="c13 c9">C. Kafka Keystores and Truststores</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c4">When Splunk UBA integrates with Kafka for high-volume data ingestion, dedicated keystores and truststores are employed to secure the communication. This enables features such as hostname verification and two-way SSL (mutual TLS) between Splunk indexers (sending data via Kafka) and UBA nodes (receiving data).</span><span class="c21 c4">3</span><span class="c1">&nbsp;This ensures that data exchanged is encrypted, authenticated, and maintains integrity, preventing unauthorized access or data manipulation during transit.</span></p><p class="c0"><span class="c9 c11 c14">Key Locations:</span></p><ul class="c19 lst-kix_list_2-0 start"><li class="c0 c7 li-bullet-0"><span class="c4">The Kafka keystore location is dynamically specified by ssl.keystore.location within the /opt/caspida/conf/kafka/kafka.properties file.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">The Kafka truststore location is typically /opt/caspida/conf/kafka/auth/server.truststore.jks.</span><span class="c3">3</span></li></ul><p class="c0"><span class="c4">The detailed steps for Kafka integration </span><span class="c21 c4">3</span><span class="c1">&nbsp;go beyond basic SSL. They include creating a self-signed CA, generating and signing server certificates, enabling hostname verification, and configuring two-way SSL (mutual TLS). This indicates a sophisticated, layered security approach for data ingestion. Hostname verification prevents connections to impostor Kafka servers, while two-way SSL ensures that</span></p><p class="c0"><span class="c4 c17">both</span><span class="c1">&nbsp;the client (Splunk search head/forwarder) and the server (UBA Kafka node) authenticate each other. This significantly raises the bar for data integrity and confidentiality during ingestion, which is paramount for a security analytics platform like UBA. Any compromise during this critical data transfer phase could lead to false positives/negatives in anomaly detection, or worse, data exfiltration or manipulation.</span></p><p class="c0 c16"><span class="c1"></span></p><h3 class="c5"><span class="c13 c9">D. Splunk UBA Web Interface Certificates</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c4">These certificates are used to secure access to the Splunk UBA web interface, ensuring that all administrative and user interactions with the UBA console are encrypted and authenticated. Replacing the default self-signed certificates with certificates issued by a trusted third-party Certificate Authority (CA) is a fundamental security best practice for production environments, enhancing user trust and preventing browser warnings.</span><span class="c3">7</span></p><p class="c0"><span class="c14 c9 c11">Key Locations:</span></p><ul class="c19 lst-kix_list_3-0 start"><li class="c0 c7 li-bullet-0"><span class="c4">By default, Splunk UBA looks in /var/vcap/caspida/certs for the necessary certificates.</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">It is recommended to specify a custom location for new certificates, such as /var/vcap/store/caspida/certs/&lt;yourcertsdir&gt; (e.g., /var/vcap/store/caspida/certs/mycerts).</span><span class="c21 c4">4</span><span class="c1">&nbsp;This custom location is crucial for upgrade resilience, as it prevents new certificates from being overwritten during UBA upgrades.</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Configuration properties for the web interface certificates are set in the /etc/caspida/local/conf/uba-site.properties file.</span><span class="c3">4</span></li></ul><p class="c0"><span class="c4">The documentation explicitly advises storing custom web interface certificates in a separate, designated directory (/var/vcap/store/caspida/certs/mycerts) to prevent them from being overwritten during UBA upgrades.</span><span class="c21 c4">4</span><span class="c1">&nbsp;This indicates a deliberate design consideration for ensuring upgrade resilience and minimizing post-upgrade configuration. More critically, the warning that actual certificate</span></p><p class="c0"><span class="c4 c17">files</span><span class="c4">&nbsp;are </span><span class="c4 c17">not</span><span class="c4">&nbsp;migrated during backup/restore operations, only the </span><span class="c4 c17">configuration</span><span class="c4">&nbsp;</span><span class="c21 c4">11</span><span class="c1">, is a vital operational detail. This means administrators must manually manage certificate files during system migrations or disaster recovery scenarios. This highlights that certificate management is not just a setup task but an ongoing operational responsibility that directly impacts system availability and security post-recovery, necessitating a proactive strategy for certificate backup, secure storage, and planned re-deployment as part of any UBA business continuity plan.</span></p><p class="c0 c16"><span class="c1"></span></p><h2 class="c22"><span class="c9 c25">III. Practical Guide to Managing UBA Keystores and Truststores</span></h2><p class="c0 c16"><span class="c8"></span></p><p class="c0 c16"><span class="c8"></span></p><h3 class="c5"><span class="c9 c13">A. Prerequisites and Environment Setup</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Before attempting any keytool or openssl operations, several foundational steps must be completed. These prerequisites are critical for successful execution and to prevent unexpected issues.</span></p><p class="c0"><span class="c11">Logging in as caspida user:</span><span class="c4">&nbsp;All certificate management operations on Splunk UBA nodes should be performed while logged in as the caspida user. This is the designated administrative user for UBA. For remote access, ssh caspida@&lt;VM-Hostname&gt; is the standard method.</span><span class="c3">1</span></p><p class="c0"><span class="c11">Setting $JAVA_HOME with CaspidaCommonEnv.sh:</span><span class="c4">&nbsp;It is crucial to correctly set the JAVA_HOME environment variable. This is typically achieved by sourcing the CaspidaCommonEnv.sh script, which configures the necessary Java runtime environment for UBA operations and ensures that keytool and other Java utilities function correctly within the UBA context.</span><span class="c21 c4">1</span><span class="c1">&nbsp;The repeated emphasis on setting</span></p><p class="c0"><span class="c1">$JAVA_HOME via CaspidaCommonEnv.sh signifies that UBA&#39;s certificate management tools (like keytool) are tightly coupled with its specific Java runtime environment. Failing to set this correctly can lead to keytool not being found, operating on the wrong Java installation, or encountering permission issues, causing command failures and potentially impacting UBA&#39;s functionality.</span></p><p class="c0"><span class="c11">Stopping UBA Services:</span><span class="c4">&nbsp;For many certificate changes, particularly those affecting core communication or the web interface, it is a common prerequisite to stop relevant Splunk UBA services (e.g., /opt/caspida/bin/Caspida stop-all or specific services like sudo service caspida-ui stop). This ensures that certificates are loaded correctly upon restart and prevents conflicts.</span><span class="c21 c4">1</span><span class="c1">&nbsp;The frequent instruction to stop UBA services before making changes highlights that many certificate updates require a clean restart to be properly recognized and applied by the running UBA processes, underscoring a critical operational dependency.</span></p><p class="c0 c16"><span class="c1"></span></p><h3 class="c5"><span class="c13 c9">B. Managing Java cacerts Truststore</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">The Java cacerts truststore is fundamental for UBA to establish trust with external Splunk components, such as Splunk Enterprise and Splunk Enterprise Security (ES).</span></p><p class="c0"><span class="c1">Importing Splunk Enterprise CA Certificates:</span></p><p class="c0"><span class="c1">The purpose of this action is to enable Splunk UBA to validate the SSL certificate of the Splunk Enterprise platform. This is essential for secure data source communication between Splunk Enterprise and UBA, and applies to both single-node and multi-node UBA deployments.</span></p><p class="c0"><span class="c1">Steps for importing:</span></p><ol class="c19 lst-kix_list_4-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">Log into the Splunk platform instance and copy the ca.pem.default certificate from /opt/splunk/etc/auth to the /home/caspida directory on the UBA management server. For multi-node deployments, this certificate also needs to be copied to Jobmanager nodes.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Log into the UBA management server as caspida and ensure JAVA_HOME is set by sourcing CaspidaCommonEnv.sh.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c1">Import the certificate into the cacerts truststore using the appropriate keytool command for the operating system.</span></li></ol><p class="c0"><span class="c1">Commands for importing:</span></p><ul class="c19 lst-kix_list_5-0 start"><li class="c0 c7 li-bullet-0"><span class="c4">On RHEL/OEL systems: sudo keytool -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit -import -trustcacerts -alias SplunkESRootCA -file ~/ca.pem.default.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">On Ubuntu/Other Linux systems: sudo keytool -keystore $JAVA_HOME/jre/lib/security/cacerts -storepass changeit -import -trustcacerts -alias SplunkESRootCA -file ~/ca.pem.default.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">For sending audit events/anomalies to Splunk ES, import the root CA certificate: sudo keytool -import -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts -file ~/cacert.pem.</span><span class="c3">2</span></li></ul><p class="c0"><span class="c1">Post-Import Configuration:</span></p><p class="c0"><span class="c1">After importing, it is crucial to enable SSL validation. Edit the /etc/caspida/local/conf/uba-site.properties file to set validate.splunk.ssl.certificate=true.1 For Splunk ES integration, also confirm</span></p><p class="c0"><span class="c4">uba.splunkes.integration.enabled=true and connectors.output.splunkes.ssl=true.</span><span class="c21 c4">2</span><span class="c1">&nbsp;Finally, restart Splunk UBA services using</span></p><p class="c0"><span class="c4">/opt/caspida/bin/Caspida stop-all followed by /opt/caspida/bin/Caspida start-all.</span><span class="c3">1</span></p><p class="c0"><span class="c1">Exporting Certificates for Backup or Migration:</span></p><p class="c0"><span class="c1">The purpose of exporting certificates is to preserve existing certificates before major UBA upgrades or system migrations, ensuring they can be re-imported later. This is a critical step for disaster recovery and maintaining system functionality.</span></p><p class="c0"><span class="c1">Commands for exporting (examples for pre-upgrade export):</span></p><ul class="c19 lst-kix_list_6-0 start"><li class="c0 c7 li-bullet-0"><span class="c4">For UBA audit events to Splunk ES: . /opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -exportcert -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts -rfc -file ~/splunk-es_cacert.pem.</span><span class="c3">7</span></li><li class="c0 c7 li-bullet-0"><span class="c4">For validating Splunk ES SSL: . /opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -exportcert -alias &quot;SplunkESRootCA&quot; -keystore $JAVA_HOME/lib/security/cacerts -rfc -file ~/SplunkESRootCA.pem.</span><span class="c3">7</span></li></ul><p class="c0"><span class="c1">Verifying Imported Certificates:</span></p><p class="c0"><span class="c1">The purpose of verification is to confirm that a certificate has been successfully imported into the cacerts truststore and to inspect its details (e.g., expiry, issuer, alias).</span></p><p class="c0"><span class="c1">Command for verification:</span></p><p class="c0"><span class="c1">../opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -list -v -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts.6 When prompted for the passcode, enter the default</span></p><p class="c0"><span class="c1">changeit.</span></p><p class="c0"><span class="c1">Table 1: Key keytool Commands for Java cacerts Truststore</span></p><p class="c0"><span class="c1">This table provides a consolidated, quick-reference guide for common keytool operations specifically applicable to the Java cacerts truststore within the Splunk UBA environment. It is invaluable for administrators needing to quickly recall or verify command syntax for certificate management tasks.</span></p><table class="c24"><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Operation</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Command</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Purpose</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Notes/Context</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Relevant Snippet IDs</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Import Certificate (Splunk ES Root CA)</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">sudo keytool -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit -import -trustcacerts -alias SplunkESRootCA -file ~/ca.pem.default</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Imports the root CA certificate from Splunk Enterprise for SSL validation.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Use appropriate $JAVA_HOME path for RHEL/OEL or Ubuntu. Default password is changeit.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">1</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Import Certificate (Splunk ES Audit Events)</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">sudo keytool -import -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts -file ~/cacert.pem</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Imports the root CA certificate for UBA to trust Splunk ES when sending audit events/anomalies.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Default password is changeit.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">2</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Export Certificate (Splunk ES Root CA)</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">. /opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -exportcert -alias &quot;SplunkESRootCA&quot; -keystore $JAVA_HOME/lib/security/cacerts -rfc -file ~/SplunkESRootCA.pem</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Exports a certificate from cacerts for backup or migration purposes.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Useful before upgrades.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">7</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Export Certificate (Splunk ES Audit Events)</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">. /opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -exportcert -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts -rfc -file ~/splunk-es_cacert.pem</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Exports a certificate from cacerts for backup or migration purposes.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Useful before upgrades.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">7</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">List Certificates</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">../opt/caspida/bin/CaspidaCommonEnv.sh sudo keytool -list -v -alias &quot;splunk es&quot; -keystore $JAVA_HOME/lib/security/cacerts</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Verifies the presence and details of a specific certificate in the truststore.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Default password is changeit.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">6</span></p></td></tr></table><p class="c16 c27"><span class="c3"></span></p><h3 class="c5"><span class="c13 c9">C. Managing the UBA-Specific Keystore (uba-keystore)</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">This keystore is integral to UBA&#39;s internal cluster communication and its direct integration with the core Splunk platform.</span></p><p class="c0"><span class="c1">Importing Certificates into uba-keystore:</span></p><p class="c0"><span class="c1">The purpose of this operation is to load certificates (e.g., from a Splunk instance) into UBA&#39;s internal keystore. This is essential for UBA to establish secure connections and trust with the integrated Splunk platform components, and for internal UBA node communication if validate.uba.ssl.certificate is enabled.</span></p><p class="c0"><span class="c1">Steps for importing:</span></p><ol class="c19 lst-kix_list_7-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">SSH to the UBA management node as the caspida user.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Stop Caspida services by running /opt/caspida/bin/Caspida stop-all.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Copy the Splunk instance certificate file (e.g., your_cert_file.pem) to the /home/caspida/ directory on the UBA management node.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Navigate to the keystore directory: cd /etc/caspida/conf/keystore/.</span><span class="c3">1</span></li><li class="c0 c7 li-bullet-0"><span class="c1">Load the certificate using the keytool command.</span></li></ol><p class="c0"><span class="c1">Command for importing:</span></p><p class="c0"><span class="c1">sudo keytool -import -alias &quot;&lt;your alias&gt;&quot; -storepass password -keystore uba-keystore -file /home/caspida/&lt;your_cert_file&gt;.pem.1</span></p><p class="c0"><span class="c1">Verifying Certificates in uba-keystore:</span></p><p class="c0"><span class="c1">The purpose of verification is to confirm successful import of a certificate and to inspect the contents and aliases within the uba-keystore.</span></p><p class="c0"><span class="c1">Command for verification:</span></p><p class="c0"><span class="c1">sudo keytool -list -storepass password -keystore uba-keystore.1</span></p><p class="c0"><span class="c1">Synchronizing uba-keystore Across UBA Nodes:</span></p><p class="c0"><span class="c1">In a distributed Splunk UBA deployment, any changes made to the uba-keystore on the management node must be propagated to all other UBA nodes (including Jobmanager nodes) to ensure consistent secure communication and authentication across the entire cluster. This is a critical step to avoid internal communication failures.</span></p><p class="c0"><span class="c1">Command for synchronization:</span></p><p class="c0"><span class="c1">/opt/caspida/bin/Caspida setup-uba-keystore.1</span></p><p class="c0"><span class="c1">Post-Synchronization:</span></p><p class="c0"><span class="c1">After synchronization, restart Caspida services on all relevant nodes using /opt/caspida/bin/Caspida start-all.1</span></p><p class="c0"><span class="c1">Table 2: Key keytool Commands for uba-keystore</span></p><p class="c0"><span class="c1">This table centralizes the keytool commands specifically used for managing the uba-keystore. It provides a clear, actionable reference for administrators to perform certificate import, verification, and cluster synchronization tasks related to UBA&#39;s internal security.</span></p><table class="c24"><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Operation</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Command</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Purpose</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Notes/Context</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Relevant Snippet IDs</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Import Certificate</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">sudo keytool -import -alias &quot;&lt;your alias&gt;&quot; -storepass password -keystore uba-keystore -file /home/caspida/&lt;your_cert_file&gt;.pem</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Loads a certificate into UBA&#39;s internal keystore, typically for Splunk instance integration.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Default password is password. Requires caspida user.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">1</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">List Certificates</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">sudo keytool -list -storepass password -keystore uba-keystore</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Verifies the presence and details of certificates within the uba-keystore.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Default password is password.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">1</span></p></td></tr><tr class="c18"><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Synchronize Keystore</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">/opt/caspida/bin/Caspida setup-uba-keystore</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Propagates uba-keystore changes from the management node to all other UBA nodes in a distributed deployment.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c1">Essential for cluster consistency.</span></p></td><td class="c6" colspan="1" rowspan="1"><p class="c0"><span class="c3">1</span></p></td></tr></table><p class="c27 c16"><span class="c3"></span></p><h3 class="c5"><span class="c13 c9">D. Managing Kafka Keystores and Truststores</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Securing Kafka data ingestion in Splunk UBA is a multi-step process involving both keytool and openssl commands to manage certificates for Kafka nodes and Splunk search heads.</span></p><p class="c0"><span class="c1">Creating Self-Signed CA Certificates (using OpenSSL):</span></p><p class="c0"><span class="c1">The purpose of this step is to establish a Root Certificate Authority (CA) if an existing enterprise CA is not available. This self-signed CA will be used to sign server and client certificates for secure Kafka communication.</span></p><p class="c0"><span class="c1">Command:</span></p><p class="c0"><span class="c1">openssl req -new -x509 -keyout new-ca-key -out new-ca-cert -days &lt;number of valid day&gt;.3</span></p><p class="c0 c16"><span class="c1"></span></p><p class="c0"><span class="c1">For distributed UBA deployments, the CA certificate should be created once and then copied to each UBA node.</span></p><p class="c0"><span class="c1">Importing Root Certificates into Kafka Keystore:</span></p><p class="c0"><span class="c1">The purpose is to trust the CA that signed the Kafka server certificates. This step is performed on each Kafka node in UBA.</span></p><p class="c0"><span class="c1">Steps for importing:</span></p><ol class="c19 lst-kix_list_8-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">Retrieve ssl.keystore.location and ssl.keystore.password from the /opt/caspida/conf/kafka/kafka.properties file.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">If an old CA certificate exists, it should be moved out of the way using keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias caroot -changealias -destalias &quot;original-caroot&quot;.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Import the new root certificate: keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias CARoot -importcert -file new-ca-cert.</span><span class="c3">3</span></li></ol><p class="c0"><span class="c1">Updating Certification Configuration on Kafka Nodes:</span></p><p class="c0"><span class="c1">This involves generating new server certificates and importing them into the Kafka keystore. This process ensures that the Kafka nodes present valid certificates to clients.</span></p><p class="c0"><span class="c1">Steps for updating:</span></p><ol class="c19 lst-kix_list_9-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c1">Log into the Kafka node as the caspida user.</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Retrieve ssl.keystore.location, ssl.keystore.password, and ssl.key.password from /opt/caspida/conf/kafka/kafka.properties.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Move the current server certificate out of the way in the keystore: keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias localhost -changealias -destalias &quot;original-localhost&quot;.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Create a new server certificate with the UBA node&#39;s hostname: keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias localhost -genkey -keyalg RSA -validity &lt;number of valid day&gt; -keypass &lt;key password&gt; -dname CN=&lt;hostname of the node&gt;.</span><span class="c3">9</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Generate a certificate request for signing the server certificate: keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias localhost -certreq -file cert-file -storepass &lt;keystore password&gt;.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Sign the new server certificate with the root certificate and import it: keytool -keystore &lt;keystore location&gt; -storepass &lt;keystore password&gt; -alias localhost -importcert -file cert-signed.</span><span class="c3">9</span></li></ol><p class="c0"><span class="c1">Configuring Two-Way SSL Communication for Kafka Data Ingestion:</span></p><p class="c0"><span class="c1">This step enables mutual TLS, where both the client (Splunk search head) and the server (UBA Kafka node) authenticate each other.</span></p><p class="c0"><span class="c1">Steps for two-way SSL:</span></p><ol class="c19 lst-kix_list_a-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">Import the root CA into a new truststore: keytool -keystore /opt/caspida/conf/kafka/auth/server.truststore.jks -storepass &lt;keystore password&gt; -alias CARoot -importcert -file new-ca-cert.</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Edit the /opt/caspida/conf/kafka/server.properties file and add the following lines:</span><span class="c14 c9 c15"><br></span><span class="c4">ssl.truststore.location=/opt/caspida/conf/kafka/auth/server.truststore.jks</span><span class="c14 c9 c15"><br></span><span class="c4">ssl.truststore.password=&lt;keystore password&gt;</span><span class="c14 c9 c15"><br></span><span class="c1">ssl.client.auth=required.3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Restart Kafka services: /opt/caspida/bin/Caspida stop-kafka followed by /opt/caspida/bin/Caspida start-kafka.</span><span class="c3">3</span></li></ol><p class="c0"><span class="c1">Configuring Splunk Search Heads for Kafka Ingestion:</span></p><p class="c0"><span class="c1">The Splunk search head also requires specific certificate configurations to securely send data to UBA via Kafka.</span></p><p class="c0"><span class="c1">Steps for search head configuration:</span></p><ol class="c19 lst-kix_list_b-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">Copy the root CA to the auth directory under the UBA Kafka Ingestion App root directory (e.g., $SPLUNK_HOME/etc/apps/Splunk-UBA-SA-Kafka/bin/auth/new-ca-cert).</span><span class="c3">3</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Create a new client key: openssl genrsa -out client-key 4096.</span><span class="c3">9</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Create a certificate request: openssl req -new -key client-key -out client-csr.</span><span class="c3">9</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Create a client certificate with the root CA and certificate request, storing it in the bin/auth directory of the UBA Kafka Ingestion App: openssl x509 -req -CA new-ca-cert -CAkey new-ca-key -in client-csr -out client-cert -days &lt;number of valid day&gt; -CAcreateserial.</span><span class="c3">9</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Create or update the local/ubakafka.conf file under the UBA Kafka Ingestion App root directory with the following:</span><span class="c14 c9 c15"><br></span><span class="c4">[kafka]</span><span class="c14 c9 c15"><br></span><span class="c4">security_protocol = SSL</span><span class="c14 c9 c15"><br></span><span class="c4">ca_cert_file = new-ca-cert</span><span class="c14 c9 c15"><br></span><span class="c4">client_cert_file = client-cert</span><span class="c14 c9 c15"><br></span><span class="c1">client_key_file = client-key.9</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Restart Splunk on the search head: ./splunk restart from the $SPLUNK_HOME/bin directory.</span><span class="c3">3</span></li></ol><p class="c0 c16"><span class="c3"></span></p><h3 class="c5"><span class="c13 c9">E. Managing Splunk UBA Web Interface Certificates</span></h3><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Securing the Splunk UBA web interface with trusted certificates is a critical step for production environments.</span></p><p class="c0"><span class="c1">Requesting and Adding a New Certificate:</span></p><p class="c0"><span class="c1">The process involves creating third-party signed certificates to replace the default self-signed ones, which enhances trust and prevents browser warnings.7</span></p><p class="c0"><span class="c1">Steps for requesting and adding:</span></p><ol class="c19 lst-kix_list_c-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c4">From the command line of the Splunk UBA management server, log in as the caspida user using SSH.</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Stop the Splunk UBA Resources Monitor (sudo service caspida-resourcesmonitor stop) and the Splunk UBA web interface (sudo service caspida-ui stop).</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Generate a new root certificate, private key, and additional certificates with the Splunk UBA hostname of the management server using sudo /opt/caspida/bin/CaspidaCert.sh &lt;country&gt; &lt;state&gt; &lt;location&gt; &lt;org&gt; &lt;domain&gt; &quot;&lt;short hostname&gt;&quot; &lt;certificate-location&gt;.</span><span class="c21 c4">4</span><span class="c4">&nbsp;It is highly recommended to specify a</span><span class="c14 c9 c15"><br></span><span class="c4">&lt;certificate-location&gt; in a different directory under /var/vcap/store/caspida/certs (e.g., /var/vcap/store/caspida/certs/mycerts) to prevent these custom certificates from being overwritten during future UBA upgrades.</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Edit the /etc/caspida/local/conf/uba-site.properties file and add the following properties to direct Splunk UBA to use the new certificate location:</span><span class="c14 c9 c15"><br></span><span class="c4">ui.auth.rootca=/var/vcap/store/caspida/certs/mycerts/my-root-ca.crt.pem</span><span class="c14 c9 c15"><br></span><span class="c4">ui.auth.privateKey=/var/vcap/store/caspida/certs/mycerts/my-server.key.pem</span><span class="c14 c9 c15"><br></span><span class="c1">ui.auth.serverCert=/var/vcap/store/caspida/certs/mycerts/my-server.crt.pem.4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Change to the Splunk UBA certificate directory (e.g., cd /var/vcap/store/caspida/certs/mycerts).</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Generate a signing request for the certificate authority using the newly created private key: sudo openssl req -new -key my-server.key.pem -out myCACertificate.csr.</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Assign appropriate permissions to the certificates directory: sudo chmod 644 /var/vcap/store/caspida/certs/mycerts/*.</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">While waiting for the certificate signing request to be returned from the CA, restart Splunk UBA and the Splunk UBA resources monitor: sudo service caspida-ui start and sudo service caspida-resourcesmonitor start.</span><span class="c21 c4">4</span><span class="c1">&nbsp;Splunk UBA will run with the self-signed certificate during this period.</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Use the Certificate Signing Request (CSR) (myCACertificate.csr) to request a new signed certificate from the Certificate Authority (CA).</span><span class="c3">4</span></li><li class="c0 c7 li-bullet-0"><span class="c4">Once the server certificate (e.g., mySplunkUBAWebCert.pem) and root CA are returned by the CA, add them to Splunk UBA. On Ubuntu systems, install the PEM-formatted root or issuing .crt file into the /usr/local/share/ca-certificates folder and run sudo update-ca-certificates.</span><span class="c3">4</span></li></ol><p class="c0"><span class="c1">Migration Considerations for Web Interface Certificates:</span></p><p class="c0"><span class="c1">When Splunk UBA is restored using a backup script, only the web interface certificate configuration is copied to the target system, not the actual certificate files themselves.11 This means that administrators must manually copy existing certificates to the restored system. If restoring to a new system with different hostnames or IP addresses, and using custom certificates or storing certificates in a non-default location, new certificates should be created on the restored system</span></p><p class="c0"><span class="c4 c17">before</span><span class="c4">&nbsp;restoring Splunk UBA.</span><span class="c21 c4">11</span><span class="c1">&nbsp;This highlights that certificate management is an ongoing operational responsibility that directly impacts system availability and security post-recovery, necessitating a proactive strategy for certificate backup, secure storage, and planned re-deployment as part of any UBA business continuity plan.</span></p><p class="c0 c16"><span class="c1"></span></p><h2 class="c22"><span class="c25 c9">IV. Security Best Practices for Keystore Management</span></h2><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Effective keystore and truststore management goes beyond mere technical execution; it encompasses a set of security best practices crucial for maintaining the integrity, confidentiality, and availability of your Splunk UBA deployment.</span></p><p class="c0"><span class="c1">Changing Default Passwords:</span></p><p class="c0"><span class="c1">The default passwords for cacerts (changeit) and uba-keystore (password) are well-known and represent significant security vulnerabilities.1 These must be changed immediately upon deployment in any production environment. While specific</span></p><p class="c0"><span class="c4">keytool commands for changing these passwords within the UBA context are not explicitly detailed in the provided documentation, general keytool commands for password changes exist, such as keytool -storepasswd -new newpassword -keystore &lt;keystore_name&gt; -storepass oldpassword.</span><span class="c21 c4">12</span><span class="c1">&nbsp;Administrators should consult broader Java</span></p><p class="c0"><span class="c1">keytool documentation and apply these principles carefully, ensuring that any changes are synchronized across the UBA cluster and updated in relevant configuration files.</span></p><p class="c0"><span class="c1">Proactive Certificate Lifecycle Management:</span></p><p class="c0"><span class="c1">Certificates have a finite lifespan. Ignoring their expiry can lead to communication failures, system outages, and security vulnerabilities. Regular monitoring of certificate expiration dates is essential. The process of exporting certificates before upgrades and re-importing them demonstrates the need for a planned approach to certificate renewals and replacements.7 This proactive management prevents unexpected disruptions to UBA&#39;s data ingestion, analysis, and integration capabilities.</span></p><p class="c0"><span class="c1">Securing Certificate Files and Directories:</span></p><p class="c0"><span class="c1">Certificate and key files are highly sensitive assets. They must be stored securely with appropriate file system permissions to prevent unauthorized access, modification, or deletion. The documentation indicates specific directories for certificates, such as /home/caspida for temporary certificate copies and /etc/caspida/conf/keystore/ for uba-keystore.1 For web interface certificates,</span></p><p class="c0"><span class="c4">/var/vcap/store/caspida/certs/&lt;yourcertsdir&gt; is recommended.</span><span class="c21 c4">4</span><span class="c1">&nbsp;Ensuring that these directories and files have restrictive permissions (e.g.,</span></p><p class="c0"><span class="c4">chmod 644 for certificates </span><span class="c21 c4">4</span><span class="c1">) is vital.</span></p><p class="c0"><span class="c1">Enabling Strict Hostname and SSL Validation:</span></p><p class="c0"><span class="c1">While some SSL validation settings might be false by default (e.g., validate.uba.ssl.certificate 8), enabling strict validation for both internal UBA communication and external connections (e.g.,</span></p><p class="c0"><span class="c4">validate.splunk.ssl.certificate=true </span><span class="c21 c4">1</span><span class="c1">&nbsp;and</span></p><p class="c0"><span class="c4">enable.strict.splunk.hostname.validation=true </span><span class="c21 c4">8</span><span class="c1">) significantly hardens the deployment. This ensures that UBA only communicates with known and trusted hosts, mitigating risks from compromised network segments or malicious actors attempting to impersonate legitimate Splunk components. When enabling strict hostname validation, providing a list of trusted hosts via the</span></p><p class="c0"><span class="c4">trusted.hosts property is also necessary.</span><span class="c3">8</span></p><p class="c0"><span class="c1">Consistency in Distributed Deployments:</span></p><p class="c0"><span class="c1">In multi-node Splunk UBA deployments, maintaining consistent certificate configurations across all nodes is paramount. Commands like /opt/caspida/bin/Caspida setup-uba-keystore 1 are provided to facilitate this synchronization. Failure to maintain consistency can lead to intermittent communication issues, authentication failures, and overall instability of the UBA cluster.</span></p><p class="c0 c16"><span class="c1"></span></p><h2 class="c22"><span class="c25 c9">V. Conclusions and Recommendations</span></h2><p class="c0 c16"><span class="c8"></span></p><p class="c0"><span class="c1">Effective keystore and truststore management is not merely a configuration task but a continuous security discipline essential for the robust operation of Splunk UBA. The analysis highlights that Splunk UBA relies on multiple distinct keystores and truststores, each serving a specific purpose in securing internal and external communications. The Java cacerts truststore is crucial for UBA&#39;s interactions with Splunk Enterprise and Splunk ES, functioning as a central anchor for validating external SSL certificates for both inbound data sources and outbound audit events. The uba-keystore is central to internal UBA cluster communication, requiring careful synchronization across all nodes in a distributed environment. Furthermore, Kafka integration introduces dedicated keystores and truststores that enable advanced security features like two-way SSL and hostname verification for high-volume data ingestion. Finally, the certificates securing the Splunk UBA web interface demand specific attention for upgrade resilience and migration planning.</span></p><p class="c0"><span class="c1">Based on this comprehensive review, the following recommendations are critical for administrators managing Splunk UBA deployments:</span></p><ol class="c19 lst-kix_list_d-0 start" start="1"><li class="c0 c7 li-bullet-0"><span class="c11">Prioritize Default Password Changes:</span><span class="c1">&nbsp;Immediately change all default keystore and truststore passwords (changeit, password) upon deployment. This is a fundamental security hardening step that significantly reduces the attack surface.</span></li><li class="c0 c7 li-bullet-0"><span class="c11">Implement Proactive Certificate Lifecycle Management:</span><span class="c1">&nbsp;Establish a rigorous process for monitoring certificate expiration dates and planning renewals. This includes regular backups of custom certificates, especially before any major UBA upgrades or migrations, to ensure business continuity and prevent unexpected outages.</span></li><li class="c0 c7 li-bullet-0"><span class="c11">Harden Internal Communication:</span><span class="c1">&nbsp;Evaluate and implement stricter validation for internal UBA communication by enabling validate.uba.ssl.certificate=true and configuring trusted.hosts where appropriate. This adds a crucial layer of security against internal threats and network compromises.</span></li><li class="c0 c7 li-bullet-0"><span class="c11">Ensure Cluster-Wide Consistency:</span><span class="c1">&nbsp;For distributed UBA deployments, consistently apply certificate changes across all nodes. Leverage built-in synchronization tools like /opt/caspida/bin/Caspida setup-uba-keystore to maintain uniform security posture and prevent communication failures.</span></li><li class="c0 c7 li-bullet-0"><span class="c11">Secure Certificate Files:</span><span class="c1">&nbsp;Enforce strict file system permissions and secure storage for all certificate and key files. Sensitive cryptographic material should be protected from unauthorized access or tampering.</span></li><li class="c0 c7 li-bullet-0"><span class="c11">Understand Integration-Specific Requirements:</span><span class="c1">&nbsp;Recognize that different integrations (e.g., Splunk Enterprise, Splunk ES, Kafka) have unique certificate management requirements. Adhere to the specific keytool and openssl commands and configuration steps provided for each integration to ensure secure and reliable data flow.</span></li></ol><p class="c26"><span class="c1">By diligently adhering to these practices, organizations can ensure that their Splunk UBA deployment operates with the highest level of security, protecting sensitive data and maintaining the integrity of their threat detection and analytics capabilities.</span></p><h4 class="c23"><span class="c9 c30">Works cited</span></h4><ol class="c19 lst-kix_list_e-0 start" start="1"><li class="c12 c7 li-bullet-0"><span class="c10">Configure Splunk UBA, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://help.splunk.com/en/security-offerings/splunk-user-behavior-analytics/install-and-upgrade/5.4.0/configure-splunk-uba/configure-splunk-uba&amp;sa=D&amp;source=editors&amp;ust=1749799710113776&amp;usg=AOvVaw0WQop2Y37cYyjK76z1kc5L">https://help.splunk.com/en/security-offerings/splunk-user-behavior-analytics/install-and-upgrade/5.4.0/configure-splunk-uba/configure-splunk-uba</a></span></li><li class="c7 c12 li-bullet-0"><span class="c10">Send Splunk UBA audit events to Splunk ES - Splunk Documentation, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Integration/SendaudittoES&amp;sa=D&amp;source=editors&amp;ust=1749799710114484&amp;usg=AOvVaw1AorSxzH9jk6mSlnoYvrMT">https://docs.splunk.com/Documentation/UBA/5.4.2/Integration/SendaudittoES</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Enable hostname verification for Kafka data ingestion - Splunk Docs, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://help.splunk.com/en/security-offerings/splunk-user-behavior-analytics/splunk-uba-kafka-ingestion-app/1.4/use-and-configure-the-splunk-uba-kafka-ingestion-app/enable-hostname-verification-for-kafka-data-ingestion&amp;sa=D&amp;source=editors&amp;ust=1749799710115429&amp;usg=AOvVaw0fftkCSjLrfUV2Vj6qOrXE">https://help.splunk.com/en/security-offerings/splunk-user-behavior-analytics/splunk-uba-kafka-ingestion-app/1.4/use-and-configure-the-splunk-uba-kafka-ingestion-app/enable-hostname-verification-for-kafka-data-ingestion</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Request and add a new certificate to Splunk UBA to access the Splunk UBA web interface - Splunk Documentation, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Install/Certificate&amp;sa=D&amp;source=editors&amp;ust=1749799710116093&amp;usg=AOvVaw09ixIaE_rRY8C8m_JqA9NG">https://docs.splunk.com/Documentation/UBA/5.4.2/Install/Certificate</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Send Splunk UBA anomalies and threats to Splunk ES as notable events, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Integration/PushUBAcontenttoES&amp;sa=D&amp;source=editors&amp;ust=1749799710116675&amp;usg=AOvVaw2gGhcH_sZXsrBi8WRiUOpF">https://docs.splunk.com/Documentation/UBA/5.4.2/Integration/PushUBAcontenttoES</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">UBA - Output Connector Server gets connection errors on sending notables (threats, anomalies) to ES, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://splunk.my.site.com/customer/s/article/UBA-Output-Connector-Server-gets-connection-errors-on-sending-notables-threats-anomalies-to-ES&amp;sa=D&amp;source=editors&amp;ust=1749799710117514&amp;usg=AOvVaw3r20uI4ho2IgUrzHqf1BhW">https://splunk.my.site.com/customer/s/article/UBA-Output-Connector-Server-gets-connection-errors-on-sending-notables-threats-anomalies-to-ES</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Upgrade a distributed OEL installation of Splunk UBA, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Install/UpgradeDistributedOEL&amp;sa=D&amp;source=editors&amp;ust=1749799710118114&amp;usg=AOvVaw0izUhUF6x5gkhSUdHz33PV">https://docs.splunk.com/Documentation/UBA/5.4.2/Install/UpgradeDistributedOEL</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Configure Splunk UBA, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Install/Configure&amp;sa=D&amp;source=editors&amp;ust=1749799710118592&amp;usg=AOvVaw1Z_24XcybX5xaNPQKmiLHC">https://docs.splunk.com/Documentation/UBA/5.4.2/Install/Configure</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Configure two-way SSL communication for Kafka data ingestion - Splunk Documentation, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBAKafkaApp/1.4.6/User/SecureKafka&amp;sa=D&amp;source=editors&amp;ust=1749799710119226&amp;usg=AOvVaw34Wn9JgH8gTp3MwgZ15NTb">https://docs.splunk.com/Documentation/UBAKafkaApp/1.4.6/User/SecureKafka</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Upgrade a distributed AMI or OVA installation of Splunk UBA, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Install/UpgradeDistributed&amp;sa=D&amp;source=editors&amp;ust=1749799710119828&amp;usg=AOvVaw1hD6Xn4N6vhhb-TbczUJaL">https://docs.splunk.com/Documentation/UBA/5.4.2/Install/UpgradeDistributed</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">How to handle your Splunk UBA web interface certificates during migration, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://docs.splunk.com/Documentation/UBA/5.4.2/Admin/MigrateCertificates&amp;sa=D&amp;source=editors&amp;ust=1749799710120413&amp;usg=AOvVaw2RShQkJQX9oIIygJh_bxoE">https://docs.splunk.com/Documentation/UBA/5.4.2/Admin/MigrateCertificates</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Changing passwords for the server KeyStore - IBM, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://www.ibm.com/docs/en/devops-release/6.2.5?topic%3Dconfiguration-changing-passwords-server-keystore&amp;sa=D&amp;source=editors&amp;ust=1749799710121010&amp;usg=AOvVaw2ljHtK5i5XzWv0zvgmzzkF">https://www.ibm.com/docs/en/devops-release/6.2.5?topic=configuration-changing-passwords-server-keystore</a></span></li><li class="c12 c7 li-bullet-0"><span class="c10">Changing passwords for the server KeyStore - IBM, accessed June 13, 2025, </span><span class="c2"><a class="c20" href="https://www.google.com/url?q=https://www.ibm.com/docs/en/devops-deploy/8.0.1?topic%3Dconfiguration-changing-passwords-server-keystore&amp;sa=D&amp;source=editors&amp;ust=1749799710121611&amp;usg=AOvVaw0ZkVMIkShN0lxlJfW6t36Y">https://www.ibm.com/docs/en/devops-deploy/8.0.1?topic=configuration-changing-passwords-server-keystore</a></span></li></ol></body></html>